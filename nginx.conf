server {
    listen 80;
    server_name localhost;
    root /usr/share/nginx/html;
    index index.html;

    # Disable aggressive browser caching - let Cloudflare handle it
    location / {
        try_files $uri $uri/ /index.html;

        # Short cache times for HTML
        location ~* \.html$ {
            add_header Cache-Control "public, max-age=60, must-revalidate";
        }

        # Short cache times for CSS/JS (versioned via query params)
        location ~* \.(css|js)$ {
            add_header Cache-Control "public, max-age=300";
        }

        # Moderate cache for images/media
        location ~* \.(jpg|jpeg|png|gif|ico|svg|mp4|mp3|webp)$ {
            add_header Cache-Control "public, max-age=3600";
        }

        # No cache for everything else
        add_header Cache-Control "no-cache, no-store, must-revalidate" always;
    }

    # Gzip compression
    gzip on;
    gzip_vary on;
    gzip_types text/plain text/css text/xml text/javascript application/javascript application/xml+rss application/json;
}
